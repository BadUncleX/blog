---
layout: post
title:  " 区块链加密技术 "
date:   2018-06-17 11:34:02 +0800
categories: blockchain 加密技术
typora-copy-images-to: ../assets/images/2018-06
typora-root-url: ../../blog_alexcode
---

# 区块链加密技术

![](/assets/images/2018-06/2018-06-18-043427.jpg)



区块链的最核心的技术是共识机制与加密算法,  今天我们就来了解下加密算法. 



区块链中用了两类加密算法: 哈希算法和非对称加密



## 哈希算法

简单说哈希算法是一个哈希函数, 将输入值X经过函数HASH的转变之后得到的值Y的过程. 

`HASH(X) = Y`

比如, 你输入"hello"得到的加过如下:

HASH(“hello”) = f572d396fae9206628714fb2ce00f72e94f2258f



### 哈希算法的4个特征

### 1) 原像不可逆

即, 你可以根据X推算出Y, 但是根据Y反过来推导出X几乎不可能.  从上面的hello的哈希值能够直观的看出来, 给你一串`f572d396fae9206628714fb2ce00f72e94f2258f` 这样的字符串很难想到它是由"hello"计算出来的. 



### 2) 难题友好

我们虽然不能根据Y直接一步就计算出X, 但是有一个本办法可以求解出X, 那就是穷举.  从这里可以看出来, 难题有好的特征保障了既能最终得到解, 但是又不会让你轻易的得到解, 理解这一点我们也就比较容易理解区块链的工作量证明(PoW)的算法. 



### 3) 发散性

也叫敏感性, 即X字符改动一个小小的字符 ,输出的Y就变得面目全非.  比如, 我们给hello字符串中间增加一个小数点he.llo来看下得到的输出:

HASH('hello') = f572d396fae9206628714fb2ce00f72e94f2258f

HASH('he.llo') = 30e4fa9b7765751ab321450c60e28c11e9e9f430



对比两个输出, 几乎毫无关联性. 



### 4) 抗碰撞性

指在给定字符串和散列值的前提下找到另一个有相同散列值的字符串，难度极高。



比如, 

HASH('hello') = f572d396fae9206628714fb2ce00f72e94f2258f



现在让你找到另一个字符, 符合其哈希值也是f572d396fae9206628714fb2ce00f72e94f2258f 非常困难. (理论上是存在的, 但概率极低)



## 对称加密

在学习非对称加密之前, 我们先简单了解下什么是对称加密. 



对称加密, 即加密和解密的密钥是相同的. 

假设我们要加密字符串"hello", 我们要预先提供一个密码, 这里假设是"password", 

则加密过程为:

ENCRYPT('hello', 'password') = 7064f8b318c61f1a

解密过程为:

DECRYPT('7064f8b318c61f1a', 'password') = hello



对称加密的有点是加解密效率高, 加密强度高; 缺点是需要多方持有密钥, 比如上述过程加密端要持有密码'password', 解密段也要有相同的密码.  一旦有人泄露的密码则安全性被破坏. 



这些问题在非对称加密中可以得到有效解决. 



## 非对称加密

非对称加密被称为现代密码学历史上最伟大的发明, 可以很好的解决对称加密需要提前分发密钥的问题. 



也就是说, 非对称加密和解密是用的两个不同的密码, 一个是私钥一个是公钥. 



公钥,就是对外公开的, 人人可以拿到; 私钥, 是自己保存的. 



非对称加密算法的安全性需要基于**数学问题**来保障，目前主要有基于大数质因子分解、离散对数、**椭圆曲线**等几种思路。



非对称加解密的优点: 公私钥分开, 不安全通道也可以使用.

缺点: 加解密速度慢, 一般比对称加解密算法慢几个数量级; 同时加密强度相比对称加密要差. 



下面看下非对称加密的应用. 

## 非对称加密应用

### 1) 信息加密

信息加密是指, 信息的发送者A使用接受者的公钥对信息加密后再发送给B, B利用自己的私钥对信息解密. 比特币交易的加密属于这种场景.  简要代码示意如下:

A.send('message', 'B pubkey') = 加密的信息

B.receive('加密的信息', 'B private key') = message



这里, 信息加密是用公钥加密, 私钥解密, 确保信息的安全性. 



### 2) 数字签名

数字签名是指, 发送者A使用自己的私钥加密信息后发送给B, B使用A的公钥对信息解密, 从而确保信息是由A发送的. 



简要代码示意如下:

A.sign('message', 'A private key') = 加密的信息

B.receive('加密的信息', 'A public key') = message



数字签名是私钥加密, 公钥解密, 主要目的是确保数字签名的归属性. 简单说就是确定信息的主人不是伪造的. 



这里说的用私钥加密, 就是指签名; 公钥, 则是用来验证信息是A发出来的. 



### 3) 登录认证

登陆认证是客户端A使用私钥加密登陆信息后发送给服务器B, 服务器接收到信息后使用该客户端A的公钥解密并认证登录信息. 



懂技术的同学可能很容易理解, 我们平时需要在本地通过SSH登陆到服务器端做维护, 为了保障登陆安全, 我们可以在本地生成一份秘钥对, 公钥传到服务器端, 私钥保存在本地, 这样我们可以不用输入密码直接登陆服务器, 原理就是我们私钥加密的信息发送到服务器端后, 服务器会用我们提供的公钥来解密并认证. 



我们已经了解了哈希算法以及非对称加密, 那么它们在区块链有哪些应用呢?  



其实应用很多, 比如区块以及区块链的结构本身就是大量的使用了哈希算法, 比特币钱包地址生成也用到了哈希算法以及非对称加密技术. 



我们重点介绍下比特币钱包地址的生成. 

## 比特币钱包地址生成

对于比特币交易来说, 我们需要从一个地址发送到另一个地址, 这里的地址就是通常说的钱包地址. 



那么钱包地址是如何生成的呢? 简单说就是通过私钥生成公钥, 再通过公钥生成钱包地址. 

### 1) 私钥生成

私钥前面介绍了, 实际是由底层操作系统生成的随机数生成器来生成的一组随机数.  比如, 下面就是一个示例私钥: 

L3U4xsdDemMjQ8zTfz5rro3SVsbARkoDqLL2dG4wnuLbL4NX2RM5



在私钥生成过程中会借助SHA256这个哈希算法来使得比较难以识别的私钥做简化转换. 

### 2) 公钥生成

公钥是在私钥的基础上生成的, 这里会用到我们之前提到的椭圆曲线加密算法. 



椭圆曲线加密算法的作用是什么?



简单说就是让私钥到公钥的生成过程安全, 即我们可以通过私钥容易的推导出公钥, 但是很难通过公钥推导出私钥.  这是非对称密码加密的基础, 即正向容易, 反向困难. 



可以认为公钥是私钥和钱包地址之间的桥梁, 通过私钥生成公钥, 通过公钥生成钱包地址. 



关于**椭圆曲线加密算法**有兴趣的朋友可以去单独了解下, 简单说就是一个数学函数, 弹球按照一定规则运动, 起点经过多次反弹后的达到终点, 但是告诉你终点位置, 你无法猜测出起点位置:

![椭圆曲线算法](/assets/images/2018-06/Bitcoin_ECDSA_2.gif)



### 3) 钱包地址生成

可以简单的理解为钱包的地址是更简短的公钥, 因为它本来就是在公钥的基础上做了转换.  这个过程中也会用到SHA256的哈希算法做转换. 



大家可以到这个地址: https://www.bitaddress.org/ 来体验下钱包地址生成, 生成完毕之后会给你一个对外的钱包地址, 以及一个私自保存的密钥. 



![](/assets/images/2018-06/2018-06-18-042840.png)



在生成的过程中需要多次晃动鼠标, 或者输入随机字符到输入框, 辅助程序做随机数生成密钥.  回顾下, 我们首先生成密钥, 然后生成公钥, 最后生成钱包地址. 



最后得到结果如下:

![](/assets/images/2018-06/2018-06-18-043008.png)

