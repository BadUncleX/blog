---
layout: post
title:  " 区块链分叉和扩容 "
date:   2018-05-10 11:34:02 +0800
categories: blockchain 分叉
typora-copy-images-to: ../assets/images/2018-05
typora-root-url: ../../blog_alexcode
---

# 区块链分叉和扩容

![](/assets/images/2018-05/2018-06-18-074601.jpg)

## 软分叉

![](/assets/images/2018-05/2018-06-18-071555.png)

软分叉是几乎每天都在发生的现实, 你可以理解为这是区块链里每天发生的自然博弈. 



我们知道, 区块代表了记账权, 也代表了利益. 既然是利益大家就要争夺, 既然要争夺我们就要制定争夺的规则. 



争夺的规则很简单, 就是大家只认最长的那条链.   比如上图中在block1后面的block2发生了软分叉, 但是因为很快上面一条线的block2后面又有了新的区块产生, 所以上面的区块链获胜, 因为全网最长. 



一般来说, 在一个区块上发生的分叉比较常见, 在连续多个区块上发生分叉是很少见的, 如下图:

![](https://alextencentcos-1256436283.file.myqcloud.com/2018-06-18-072027.png)



软分叉的背后,实际是算力的竞争, 如果你的算力超强甚至可以51%攻击, 把已经产生的交易逆转, 因为算力强最终可以产生更长的链而最终被全网共识认可. 



我们可以类比现实生活中的皇子竞争, 皇帝有2个儿子, 但是继承皇位的只有一个, 共识就是大臣们认可以及拿到皇帝的玉玺.  一开始的时候大太子获胜, 大家认可大太子 ,但是最后小皇子绝地反击设计把大皇子干死了, 玉玺回到小皇子手里, 这时大家也只好认小皇子是皇帝了.  区块链里的算力可以类比为这里的暴力, 谁兵强马壮谁最后获得皇位(记账权).





## 硬分叉

软分叉再怎么分叉最后还是一条主链, 即过程是反复的, 但结果是统一的. 

而硬分叉直接就是两个儿子分家, 各过各的了, 所以, 硬分叉其实算是共识的分裂. 



硬分叉是修改了协议, 比如说修改了算法的难度, 导致出块速度也会变化.  一般来说, 新的硬分叉因为刚开始算力较小, 大多会修改算法难度, 让出块速度变快. 



硬分叉是一个合谋的协同, 代码开发人员部署了新的协议版本的区块链, 部署完了之后还要旷工和客户端来接受你, 认可新的分叉的旷工和客户端自然会升级自己的协议.  



比特币有很多次的硬分叉,  下图是Bitcoin Cash硬分叉的特性变化:

![](/assets/images/2018-05/2018-06-18-075513.jpg)



可以看出Bitcoin Cash 将区块容量从原有的1MB提升到了8MB.

比特币现金在2017年8月1日, 在当时区块高度是478558的地方硬分叉,  每个原来拥有BTC的人都会等额的分到一个BCH (赚了). 



## 比特币扩容

中本聪在设计比特币的时候, 约定每 10 分钟产生一个区块, 这个速度在今天越来越不符合日益增长的交易需求了. 



比特币的扩容和硬分叉基本上如影随形. 

我们前面提到的硬分叉基本也会涉及到同时需要扩容, 但扩容未必需要分叉.  



比特币的扩容的目的是为了让一个区块容纳的交易数量更多, 可以理解为提升了交易的带宽速度, 因为一次打包包含的交易数量上去了. 



比特币的一个扩容方式是**隔离见证**. 

简单来说, 隔离见证就是将签名部分从结构体里迁移出来, 在原来的地方放一个指针指向这个签名, 这样这个签名的空间就被节省了, 从而变相增大了空间. 



当然, 为了提升交易速度不仅仅可以通过扩容的方式, 也可以通过闪电网络这类方式变相扩容, 因为最终交易速度上去了. 

**闪电网络**, 简单来说就是将原来需要在线上频繁做的交易, 将中间过程放到链外做, 最后的结果再同步到主链上, 这样也变相提升了区块链的速度.  类比为你和银行结算速度会比较慢, 但是通过支付宝平台会比较快, 因为支付宝首先在平台内部和你直接结算, 然后支付宝平台将最终结果再和银行结算, 就快很多了. 

